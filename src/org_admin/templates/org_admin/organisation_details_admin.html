{% extends 'org_admin/navigation_template.html' %} {% block page_content %}

<p class="text-2xl font-bol mb-5">About your Organisation</p>
{% if error %}
{{ error }}
{% endif %}

<div class="p-5 rounded-lg bg-gray-700 mb-3">
  <div class="flex justify-between items-center">
    <p class="text-xl">Details</p>
    <button
      class="btn btn-primary"
      hx-get="/org_admin/add_location"
      hx-on:htmx:after-request="my_modal_2.showModal();"
      hx-target="#modalDiv"
      hx-swap="innerHTML"
    >
      Save
    </button>
  </div>
  <div class="divider"></div>
  <form>
    <input
      type="text"
      class="input input-bordered w-full mb-3"
      placeholder="Organisation Name"
      value="{{ organisation.name }}"
    />
    <br />
    <textarea
      class="textarea textarea-bordered w-full text-wrap"
      placeholder="Organisation Description"
    >
{{ organisation.description }}</textarea
    >
  </form>
</div>

<div class="p-5 rounded-lg bg-gray-700 mb-3">
  <div class="flex justify-between items-center">
    <p class="text-xl">Locations</p>
    <button
      class="btn btn-primary"
      hx-get="/org_admin/add_location"
      hx-on:htmx:after-request="my_modal_2.showModal();"
      hx-target="#modalDiv"
      hx-swap="innerHTML"
    >
      Add a Location
    </button>
  </div>
  <div class="divider"></div>
  {% if locations|length == 0 %}
  <p>No locations have been added yet</p>
  {% else %}
  <table class="table">
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Address</th>
      <th>City</th>
      <th>Postcode</th>
      <th>Actions</th>
    </tr>
    {% for location in locations %}
    <tr>
      <td>{{ location.name }}</td>
      <td>{{ location.description }}</td>
      <td>{{ location.first_line }}</td>
      <td>{{ location.city }}</td>
      <td>{{ location.postcode }}</td>
      <td>
        <button
          class="btn btn-primary"
          hx-get="/org_admin/edit_location/{{ location.id }}"
          hx-on:htmx:after-request="my_modal_2.showModal();"
          hx-target="#modalDiv"
          hx-swap="innerHTML"
        >
          Edit
        </button>
        <a
          href="/org_admin/delete_location/{{ location.id }}"
          class="btn btn-danger"
          >Delete</a
        >
      </td>
    </tr>
    {% endfor %}
  </table>
  {% endif %}
</div>

<div class="p-5 rounded-lg bg-gray-700">
  <div class="flex justify-between items-center">
    <p class="text-xl">Media</p>
    <p class="text-gray-500">Hover over media to delete.<br>Please note you need more than 1 image to be able to delete.</p>
    <button
      class="btn btn-primary"
      hx-get="/org_admin/upload_media/organisation_image/"
      hx-on:htmx:after-request="my_modal_2.showModal();"
      hx-target="#modalDiv"
      hx-swap="innerHTML"
    >
      Upload
    </button>
  </div>
  <div class="divider"></div>
  <div class='flex w-full overflow-auto flex-wrap justify-center'>
    {% for image in org_images%} 
    
    <div class="mr-3 mb-3 relative w-48 h-40 ">
      {% if org_images|length > 1 %}
      <div class="flex flex-col p-2 items-center justify-center bg-slate-300 absolute w-full h-full hover:opacity-100 z-10 rounded-xl opacity-0">
        <button class="btn btn-danger" hx-get="/org_admin/delete_media/organisation_image/{{image.id}}/image/">Delete</button>
      </div>
      {% endif %}
      <div>
        <img src="{{image.image.url}}" alt="" class="absolute w-full h-full z-0 object-cover rounded-xl" />
      </div>
    </div>
    {%endfor%}
  </div>
</div>

<!-- Open the modal using ID.showModal() method -->
<dialog id="my_modal_2" class="modal">
  <div id="modalDiv" class="modal-box">
    <h3 class="font-bold text-lg">Hello!</h3>
    <p class="py-4">Press ESC key or click outside to close</p>
  </div>
  <form method="dialog" class="modal-backdrop">
    <button>close</button>
  </form>
</dialog>

{% endblock %}