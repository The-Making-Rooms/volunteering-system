{% extends 'org_admin/navigation_template.html' %}

{% block page_content %}

    <div class="flex flex-col space-y-4">



    <div class="flex items-start justify-between">
        <div class="flex flex-col space-y-2">
            <p class="text-2xl font-bold mb-3">Rota for: {{ opportunity.name }}</p>
            <p class="text-slate-400">
            Use this screen to manage your opportunities schedule and roles. Once you have approved registrations, use the "Assign shifts" button to assign shifts and get responses from volunteers.
            </p>
        </div>


        <button
            hx-get="/org_admin/rota/assign/{{ opportunity.id }}/"
            hx-target=".htmx-navigator"
            hx-swap="outerHTML"
            class="btn btn-primary btn-sm">
            Assign Shifts
        </button>
    </div>



    <div class="divider"></div>



    <div class="flex flex-col p-5 bg-base-200 rounded-md mb-3">
        <div class="flex items-center justify-between">
            <p class="text-2xl font-bold">Schedules</p>
            <button
                hx-get="/org_admin/rota/schedule/new/{{ opportunity.id }}/"
                hx-target=".htmx-navigator"
                hx-swap="outerHTML"
                class="btn btn-primary btn-sm">
                New Schedule
            </button>
        </div>

    <div class="divider"></div>

        {% if schedules|length > 0 %}
            <table class="w-full table table-sm">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Start Time</th>
                    <th>End Time</th>
                    <th>Action</th>
                </tr>
            </thead>

            <tbody>
                {% for schedule in schedules %}
                    <tr class="hover:bg-base-300 border-b border-base-300">
                        <td>{{ schedule.date }}</td>
                        <td>{{ schedule.start_time }}</td>
                        <td>{{ schedule.end_time }}</td>
                        <td>
                            <button
                                    class="btn btn-primary btn-sm"
                                    hx-get="/org_admin/rota/schedule/{{ schedule.id }}/"
                                    hx-target=".htmx-navigator"
                                    hx-swap="outerHTML"
                            >Edit</button>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>


            </table>

        {% else %}
            <p>No schedules found.</p>
        {% endif %}
    </div>



<div class="flex flex-col p-5 bg-base-200 rounded-md">
    <div class="flex items-center justify-between">
        <p class="text-2xl font-bold">Roles</p>
        <button
            hx-get="/org_admin/rota/role/new/{{ opportunity.id }}/"
            hx-target=".htmx-navigator"
            hx-swap="outerHTML"
            class="btn btn-primary btn-sm">
            New Role
        </button>
    </div>

    <div class="divider"></div>

    <table class="w-full table table-sm">
        <thead>
            <tr>
                <th>Role</th>
                <th>Description</th>
                <th>Number of volunteers</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for role in roles %}
                    <tr class="hover:bg-base-300 border-b border-base-300">
                        <td>{{ role.name }}</td>
                        <td>{{ role.description }}</td>
                        <td>{{ role.number_of_volunteers }}</td>
                        <td>
                            <button
                                hx-get="/org_admin/rota/role/{{ role.id }}/"
                                hx-target=".htmx-navigator"
                                hx-swap="outerHTML"
                                class="btn btn-primary btn-sm">
                                Edit
                            </button>
                        </td>
                    </tr>
            {% endfor %}
        </tbody>
    </table>


</div>

    </div>

{% endblock %}